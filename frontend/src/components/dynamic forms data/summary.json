{
  "report_name": "Savings_Product_Sum_S",
  "base_query": "SELECT pl_month_tb.id, pl_month_tb.pl_account_id, pl_month_tb.branch_month_id, pl_month_tb.month_debit, pl_month_tb.month_credit, pl_month_tb.paid_interest, pl_month_tb.paid_penalty, pl_month_tb.closing_balance, pl_month_tb.passdue_amount, pl_month_tb.interest_reservation, pl_month_tb.status, pl_account.id, ci_customer.id, pl_account.ci_customer_id, ci_customer.customer_number, pl_account_type.id, pl_account_type.period_max, pl_account_type.period_min, pl_account_type.interest_policy, pl_account_type.interest_update_policy, pl_account_type.interest_rate_max, pl_account_type.interest_rate_min, pl_account_type.penalty_policy, pl_account_type.penalty_rate, pl_account_type.insurance_policy, pl_account_type.insurance_rate, pl_account_type.fee_policy, pl_account_type.fee_rate, pl_account_type.minimum_balance, pl_account_type.field_collection, pl_account_type.allow_interest_edit, pl_account_type.loan_schedule_type, pl_account_type.tax_minimum_balance, pl_account_type.tax_rate, pl_account_type.no_of_loan_guarantor, pl_account_type.passdue_policy, pl_account_type.status, pl_account.pl_account_type_id, pl_month_tb.id, gl_branch.telephone, pl_month_tb.status, it_institute.id, it_institute.email, it_institute.phone, it_institute.reg_num, it_institute.reg_date, it_institute.sms_mask, it_institute.sms_mask_id, it_institute.swift_code, it_institute.status, pl_account_type.it_institute_id, pl_account.open_date, pl_account.reneve_date, pl_account.ref_account_number, it_user_master.id, it_user_master.customer_id, it_user_master.name, it_user_master.status, it_user_master.active_branch_id, pl_account_type.it_institute_id, it_generated_reports.id, it_generated_reports.user_id, it_generated_reports.it_institute_id, it_generated_reports.date_from, it_generated_reports.date_to, it_generated_reports.value_from, it_generated_reports.value_to, it_generated_reports.cash_open, it_generated_reports.cash_closing, it_generated_reports.bank_open, it_generated_reports.bank_closing, it_generated_reports.filter_1_text, it_generated_reports.filter_2_text, it_generated_reports.filter_1_value, it_generated_reports.filter_2_value, pl_account_type.pl_account_category_id, pl_account.status, gl_branch.id, gl_branch.it_institute_id, gl_branch.status, it_institute.name_ln1, it_institute.name_ln2, it_institute.name_ln3, it_institute.address_ln1, it_institute.address_ln3, it_institute.address_ln2, ci_customer.full_name_ln1, ci_customer.full_name_ln2, ci_customer.full_name_ln3, pl_account_type.name_ln1, pl_account_type.name_ln2, pl_account_type.name_ln3, gl_branch.name_ln1, gl_branch.name_ln2, gl_branch.name_ln3, pl_month_tb.age, it_branch_month.id, it_branch_month.status, it_generated_reports.branch_id FROM pl_month_tb INNER JOIN pl_account ON pl_month_tb.pl_account_id = pl_account.id INNER JOIN ci_customer ON pl_account.ci_customer_id = ci_customer.id INNER JOIN pl_account_type ON pl_account.pl_account_type_id = pl_account_type.id INNER JOIN gl_branch ON pl_account.branch_id = gl_branch.id AND ci_customer.branch_id = gl_branch.id INNER JOIN it_institute ON it_institute.id = gl_branch.it_institute_id INNER JOIN it_branch_month ON it_branch_month.id = pl_month_tb.branch_month_id INNER JOIN it_generated_reports ON it_generated_reports.branch_id = gl_branch.id INNER JOIN it_user_master ON it_user_master.id = it_generated_reports.user_id WHERE pl_month_tb.closing_balance <> 0 AND pl_account_type.pl_account_category_id = 1 AND pl_month_tb.branch_month_id = it_generated_reports.filter_2_value AND it_generated_reports.id = $P{parm_a} ORDER BY pl_account_type.id ASC, pl_account.ref_account_number ASC",
  "headings": {
    "main_heading": {
      "expression": "$F{name_ln2}+' - ' +'ශාඛාව ( '+$F{COLUMN_94}",
      "fields": ["it_institute.name_ln2", "gl_branch.name_ln1"],
      "placeholder": "{it_institute.name_ln2} - ශාඛාව ( {gl_branch.name_ln1}",
      "note": "COLUMN_94 maps to gl_branch.name_ln1"
    },
    "sub_heading": {
      "expression": "$P{parm_b}",
      "fields": ["date_range"],
      "placeholder": "Savings Product Summary for {date_range}",
      "parameter_name": "parm_b",
      "note": "parm_b is a parameter that typically contains the date for the product summary report"
    }
  },
  "select_fields": [
    "pl_month_tb.id",
    "pl_month_tb.pl_account_id",
    "pl_month_tb.branch_month_id",
    "pl_month_tb.month_debit",
    "pl_month_tb.month_credit",
    "pl_month_tb.paid_interest",
    "pl_month_tb.paid_penalty",
    "pl_month_tb.closing_balance",
    "pl_month_tb.passdue_amount",
    "pl_month_tb.interest_reservation",
    "pl_month_tb.status",
    "pl_month_tb.age",
    "pl_account.id",
    "pl_account.ci_customer_id",
    "pl_account.pl_account_type_id",
    "pl_account.open_date",
    "pl_account.reneve_date",
    "pl_account.ref_account_number",
    "pl_account.status",
    "ci_customer.id",
    "ci_customer.customer_number",
    "ci_customer.full_name_ln1",
    "ci_customer.full_name_ln2",
    "ci_customer.full_name_ln3",
    "pl_account_type.id",
    "pl_account_type.period_max",
    "pl_account_type.period_min",
    "pl_account_type.interest_policy",
    "pl_account_type.interest_update_policy",
    "pl_account_type.interest_rate_max",
    "pl_account_type.interest_rate_min",
    "pl_account_type.penalty_policy",
    "pl_account_type.penalty_rate",
    "pl_account_type.insurance_policy",
    "pl_account_type.insurance_rate",
    "pl_account_type.fee_policy",
    "pl_account_type.fee_rate",
    "pl_account_type.minimum_balance",
    "pl_account_type.field_collection",
    "pl_account_type.allow_interest_edit",
    "pl_account_type.loan_schedule_type",
    "pl_account_type.tax_minimum_balance",
    "pl_account_type.tax_rate",
    "pl_account_type.no_of_loan_guarantor",
    "pl_account_type.passdue_policy",
    "pl_account_type.status",
    "pl_account_type.it_institute_id",
    "pl_account_type.pl_account_category_id",
    "pl_account_type.name_ln1",
    "pl_account_type.name_ln2",
    "pl_account_type.name_ln3",
    "gl_branch.id",
    "gl_branch.it_institute_id",
    "gl_branch.telephone",
    "gl_branch.status",
    "gl_branch.name_ln1",
    "gl_branch.name_ln2",
    "gl_branch.name_ln3",
    "it_institute.id",
    "it_institute.email",
    "it_institute.phone",
    "it_institute.reg_num",
    "it_institute.reg_date",
    "it_institute.sms_mask",
    "it_institute.sms_mask_id",
    "it_institute.swift_code",
    "it_institute.status",
    "it_institute.name_ln1",
    "it_institute.name_ln2",
    "it_institute.name_ln3",
    "it_institute.address_ln1",
    "it_institute.address_ln2",
    "it_institute.address_ln3",
    "it_user_master.id",
    "it_user_master.customer_id",
    "it_user_master.name",
    "it_user_master.status",
    "it_user_master.active_branch_id",
    "it_generated_reports.id",
    "it_generated_reports.user_id",
    "it_generated_reports.it_institute_id",
    "it_generated_reports.date_from",
    "it_generated_reports.date_to",
    "it_generated_reports.value_from",
    "it_generated_reports.value_to",
    "it_generated_reports.cash_open",
    "it_generated_reports.cash_closing",
    "it_generated_reports.bank_open",
    "it_generated_reports.bank_closing",
    "it_generated_reports.filter_1_text",
    "it_generated_reports.filter_2_text",
    "it_generated_reports.filter_1_value",
    "it_generated_reports.filter_2_value",
    "it_generated_reports.branch_id",
    "it_branch_month.id",
    "it_branch_month.status"
  ],
  "search_fields": [
    "it_generated_reports.id",
    "pl_account_type.pl_account_category_id",
    "pl_month_tb.branch_month_id",
    "it_generated_reports.filter_2_value"
  ],
  "sort_fields": [
    { "field": "pl_account_type.id", "direction": "ASC" },
    { "field": "pl_account.ref_account_number", "direction": "ASC" }
  ],
  "report_layout_fields": {
    "column_headers": [
      {
        "field": "Product Type",
        "width": 172,
        "alignment": "Left",
        "text": "ඉතිරිකිරීමේ වර්ගය"
      },
      {
        "field": "Customer Count",
        "width": 110,
        "alignment": "Right",
        "text": "ගනුදෙනුකරු සංඛ්‍යාව"
      },
      { "field": "Balance", "width": 75, "alignment": "Right", "text": "ශේෂය" }
    ],
    "detail_fields": [],
    "group_header_fields": [],
    "group_footer_fields": [
      {
        "field": "product_type_name",
        "type": "field",
        "source": "pl_account_type.name_ln1",
        "column_reference": "COLUMN_91",
        "alignment": "Left",
        "font": "FMAbhaya",
        "size": 12,
        "bold": false
      },
      {
        "field": "product_customer_count",
        "type": "variable",
        "source": "closing_balance4",
        "format": "#,##0.###;(#,##0.###-)",
        "alignment": "Right",
        "font": "Calibri",
        "bold": false
      },
      {
        "field": "product_balance_total",
        "type": "variable",
        "source": "closing_balance1",
        "format": "#,##0.00#;(#,##0.00#)",
        "alignment": "Right",
        "font": "Calibri",
        "bold": false
      }
    ],
    "footer_fields": [
      {
        "field": "sub_total_label",
        "type": "static",
        "value": "උප එකතුව",
        "alignment": "Left",
        "font": "FMAbhaya",
        "size": 12,
        "bold": true
      },
      {
        "field": "sub_total_balance",
        "type": "variable",
        "source": "closing_balance2",
        "format": "#,##0.00#;(#,##0.00#)",
        "alignment": "Right",
        "font": "Calibri",
        "bold": true
      },
      {
        "field": "report_title",
        "type": "static",
        "value": "AI Banker - ඉතිරිකිරීම් සාරාංශය - PS 01",
        "alignment": "Left",
        "font": "Iskoola Pota",
        "size": 7
      },
      {
        "field": "page_number",
        "type": "calculated",
        "expression": "'පිටුව ' + $V{PAGE_NUMBER}",
        "alignment": "Left",
        "font": "FMAbhaya",
        "size": 7
      },
      {
        "field": "total_pages",
        "type": "calculated",
        "expression": "' සිට  ' + $V{PAGE_NUMBER}",
        "alignment": "Left",
        "font": "FMAbhaya",
        "size": 7,
        "evaluation_time": "Report"
      },
      {
        "field": "printed_by_label",
        "type": "static",
        "value": "මුද්‍රණය -",
        "alignment": "Left",
        "font": "FMAbhaya",
        "size": 7
      },
      {
        "field": "user_name",
        "type": "field",
        "source": "it_user_master.name",
        "alignment": "Left",
        "font": "Calibri",
        "size": 7
      },
      {
        "field": "printed_by_closing",
        "type": "static",
        "value": "පරිශීලකයා (",
        "alignment": "Right",
        "font": "FMAbhaya",
        "size": 7
      },
      {
        "field": "print_date",
        "type": "calculated",
        "format": "MMM d, yyyy h:mm:ss a",
        "expression": "new java.util.Date()",
        "alignment": "Right",
        "font": "Calibri",
        "size": 7
      }
    ],
    "summary_fields": [
      {
        "field": "grand_total_label",
        "type": "static",
        "value": "මුළු එකතුව",
        "alignment": "Left",
        "font": "FMAbhaya",
        "size": 12,
        "bold": true
      },
      {
        "field": "grand_total_customer_count",
        "type": "variable",
        "source": "closing_balance10",
        "alignment": "Right",
        "font": "Calibri",
        "bold": true
      },
      {
        "field": "grand_total_balance",
        "type": "variable",
        "source": "closing_balance3",
        "format": "#,##0.00#;(#,##0.00#)",
        "alignment": "Right",
        "font": "Calibri",
        "bold": true
      },
      {
        "field": "prepared_by_label",
        "type": "static",
        "value": "සකස්කරන ලද්දේ (",
        "alignment": "Left",
        "font": "FMAbhaya",
        "size": 12
      }
    ]
  },
  "calculated_fields": [
    {
      "name": "product_summary_balance",
      "fields_included": ["pl_month_tb.closing_balance"],
      "calculation_logic": "$F{closing_balance}",
      "description": "Aggregate closing balance by product type"
    },
    {
      "name": "product_type_display",
      "fields_included": ["pl_account_type.name_ln1"],
      "calculation_logic": "$F{COLUMN_91}",
      "description": "Display product type name in local language"
    },
    {
      "name": "institute_branch_display",
      "fields_included": ["it_institute.name_ln2", "gl_branch.name_ln1"],
      "calculation_logic": "$F{name_ln2}+' - ' +'ශාඛාව ( '+$F{COLUMN_94}",
      "description": "Combine institute and branch names for header display"
    },
    {
      "name": "customer_count_by_product",
      "fields_included": ["pl_account.id"],
      "calculation_logic": "COUNT($F{pl_account.id})",
      "description": "Count number of customers per product type"
    }
  ],
  "variables": [
    {
      "name": "closing_balance1",
      "class": "java.lang.Double",
      "resetType": "Group",
      "resetGroup": "Group1",
      "calculation": "Sum",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance2",
      "class": "java.lang.Double",
      "resetType": "Column",
      "calculation": "Sum",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance3",
      "class": "java.lang.Double",
      "calculation": "Sum",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance4",
      "class": "java.lang.Integer",
      "resetType": "Group",
      "resetGroup": "Group1",
      "calculation": "Count",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance5",
      "class": "java.lang.Integer",
      "resetType": "Column",
      "calculation": "Count",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance6",
      "class": "java.lang.Integer",
      "resetType": "Column",
      "calculation": "Count",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance7",
      "class": "java.lang.Integer",
      "resetType": "Column",
      "calculation": "Count",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance8",
      "class": "java.lang.Integer",
      "resetType": "Column",
      "calculation": "Count",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance9",
      "class": "java.lang.Double",
      "resetType": "Column",
      "calculation": "Sum",
      "expression": "$F{closing_balance}"
    },
    {
      "name": "closing_balance10",
      "class": "java.lang.Integer",
      "calculation": "Count",
      "expression": "$F{closing_balance}"
    }
  ],
  "parameters": [
    {
      "field": "id",
      "name": "parm_a",
      "class": "java.lang.Integer",
      "reference": "it_generated_reports.id",
      "table": "it_generated_reports",
      "description": "Report ID parameter for filtering specific generated report"
    },
    {
      "field": "report_date",
      "name": "parm_b",
      "class": "java.lang.String",
      "reference": "report_date_display",
      "table": "it_generated_reports",
      "description": "Report date parameter for product summary display"
    }
  ],
  "groups": [
    {
      "name": "Group1",
      "groupExpression": "$F{COLUMN_91}",
      "description": "Group by product type (pl_account_type.name_ln1) to summarize savings products",
      "isStartNewPage": false,
      "field_mapping": { "COLUMN_91": "pl_account_type.name_ln1" }
    }
  ],
  "database_tables": [
    {
      "name": "pl_month_tb",
      "alias": "pl_month_tb",
      "description": "Personal loan monthly trial balance with closing balances and transaction details"
    },
    {
      "name": "pl_account",
      "alias": "pl_account",
      "description": "Personal loan account master data including account numbers and dates"
    },
    {
      "name": "ci_customer",
      "alias": "ci_customer",
      "description": "Customer master information including names and addresses"
    },
    {
      "name": "pl_account_type",
      "alias": "pl_account_type",
      "description": "Personal loan account type master with interest rates and policies"
    },
    {
      "name": "gl_branch",
      "alias": "gl_branch",
      "description": "Branch information and contact details"
    },
    {
      "name": "it_institute",
      "alias": "it_institute",
      "description": "Institute/company master information and registration details"
    },
    {
      "name": "it_branch_month",
      "alias": "it_branch_month",
      "description": "Branch monthly period management"
    },
    {
      "name": "it_generated_reports",
      "alias": "it_generated_reports",
      "description": "Generated report parameters, filters and metadata"
    },
    {
      "name": "it_user_master",
      "alias": "it_user_master",
      "description": "User master data for report generation and authorization"
    }
  ],
  "report_type": "savings_product_summary",
  "orientation": "portrait",
  "page_format": "A4",
  "business_purpose": "Savings product summary report showing aggregated balances and customer counts grouped by account type for management analysis and decision making",
  "key_features": [
    "Product-centric aggregation and summary",
    "Customer count tracking by product type",
    "Balance aggregation with multiple totaling levels",
    "Multi-language support (Sinhala labels)",
    "Branch-specific filtering",
    "Account category filtering (savings accounts only)",
    "Age tracking for accounts",
    "Comprehensive totaling at group and grand total levels"
  ],
  "filtering_criteria": [
    {
      "field": "pl_month_tb.closing_balance",
      "condition": "<> 0",
      "description": "Only include accounts with non-zero closing balances"
    },
    {
      "field": "pl_account_type.pl_account_category_id",
      "condition": "= 1",
      "description": "Filter for savings account category only"
    },
    {
      "field": "pl_month_tb.branch_month_id",
      "condition": "= it_generated_reports.filter_2_value",
      "description": "Filter by specific branch month period"
    },
    {
      "field": "it_generated_reports.id",
      "condition": "= $P{parm_a}",
      "description": "Filter by specific report generation ID"
    }
  ],
  "column_mappings": [
    {
      "column_name": "COLUMN_91",
      "actual_field": "pl_account_type.name_ln1",
      "description": "Product type name in local language"
    },
    {
      "column_name": "COLUMN_94",
      "actual_field": "gl_branch.name_ln1",
      "description": "Branch name in local language"
    }
  ]
}
